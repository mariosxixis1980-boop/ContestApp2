<!doctype html>
<html lang="el">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Reset Password</title>

<style>
body{
  font-family:system-ui;
  background:#070b13;
  color:#eaf1ff;
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:100vh;
}
.card{
  width:360px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.15);
  border-radius:16px;
  padding:20px;
}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:none;
  margin-top:10px;
}
button{
  margin-top:12px;
  padding:10px;
  width:100%;
  border-radius:12px;
  border:none;
  background:#2ecc71;
  font-weight:700;
  cursor:pointer;
}
.msg{margin-top:10px;font-size:14px}
</style>
</head>

<body>
<div class="card">
  <h2>ğŸ” ÎÎ­Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚</h2>
  <p>Î’Î¬Î»Îµ Î½Î­Î¿ password ÎºÎ±Î¹ Ï€Î¬Ï„Î± Â«Î‘Î»Î»Î±Î³Î®Â».</p>

  <input id="newPass" type="password" placeholder="ÎÎ­Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚"/>
  <button id="saveBtn">âœ… Î‘Î»Î»Î±Î³Î® ÎºÏ‰Î´Î¹ÎºÎ¿Ï</button>

  <div id="msg" class="msg"></div>
</div>

<script type="module">
import { supabase } from "./supabase.js";

const msg = (t,c="")=>{
  const m=document.getElementById("msg");
  m.textContent=t;
  m.style.color=c||"#ffdede";
};

document.getElementById("saveBtn").addEventListener("click", async ()=>{
  const password=document.getElementById("newPass").value;
  if(!password) return msg("Î“ÏÎ¬ÏˆÎµ Î½Î­Î¿ ÎºÏ‰Î´Î¹ÎºÏŒ.");

  // â¬‡ï¸ Î Î‘Î™Î¡ÎÎŸÎ¥ÎœÎ• Î¤ÎŸ SESSION Î‘Î ÎŸ Î¤ÎŸ RESET LINK
  const { data:{session} } = await supabase.auth.getSession();
  if(!session) return msg("âŒ Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ session reset.");

  const { error } = await supabase.auth.updateUser({ password });
  if(error) return msg("Error: "+error.message);

  msg("âœ… ÎŸ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Î¬Î»Î»Î±Î¾Îµ! Î Î®Î³Î±Î¹Î½Îµ ÏƒÏ„Î¿ login.","#9cffc7");

  setTimeout(()=>{
    location.href="login.html";
  },1500);
});
</script>
</body>
</html>
